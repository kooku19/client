<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Covid-19</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
        integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
        crossorigin="" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@300&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
        integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
        crossorigin=""></script>

</head>

<body>
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark">
        <img class="logo" src="images/logo.png">
        &nbsp;&nbsp;

        <a class="navbar-brand" href="index.html">
            <p class="h2">Covid-19</p>
        </a>

        <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#collapsibleNavId"
            aria-controls="collapsibleNavId" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="collapsibleNavId">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="confirmed.html">Confirmed</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="deceased.html">Deceased</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="recovered.html">Recovered</a>
                </li>

            </ul>

        </div>
    </nav>
    <br>
    <center>

        <div class="container">
            <div id="mapid"></div>
            <meta charset="utf-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
        </div>
    </center><br>

    <div class="container">

        <div class="row gx-5">
            <div class="col">
                <a href="confirmed.html">
                    <div class="card text-white bg-warning mb-3">
                        <div class="card-body">
                            <center>
                                <h4 class="card-title text-white ">Confirm</h4>
                                <h1>
                                    <div class="bg-white rounded ">
                                        <strong <p class="card-text" id="confirmed" style="color: black;"></p></strong>
                                        
                                    </div>
                                </h1>
                                worldwide cases
                                </p>
                            </center>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col">
                <a href="deceased.html">
                    <div class="card text-white bg-danger mb-3">
                        <div class="card-body">
                            <center>
                                <h4 class="card-title text-white ">Deceased</h4>
                                <h1>
                                    <div class="bg-white rounded ">
                                        <strong <p class="card-text" id="death" style="color: black;"></p></strong>
                                        
                                    </div>
                                </h1>
                                worldwide cases
                                </p>
                            </center>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col">
                <a href="recovered.html">
                    <div class="card text-white bg-success mb-3">
                        <div class="card-body">
                            <center>
                                <h4 class="card-title text-white ">Recovered</h4>
                                <h1>
                                    <div class="bg-white rounded ">
                                        <strong <p class="card-text" id="recovered" style="color: black;"></p></strong>

                                    </div>
                                </h1>
                                worldwide cases
                                </p>
                            </center>
                        </div>

                    </div>
                </a>
            </div>
        </div>


        <div class=" container">
            <br>
            <div class="card bg-white">
                <div class="card-body">
                    <p class="h4"><strong>TOP 10</strong></p>
                    The table shows the highest number of infected cases in the top 10 in the world.
                </div>
            </div>
            <br>

            <table class="table table-light table-striped">
                <thead class="caption-top">
                    <tr>
                        <th>No.</th>
                        <th>Province</th>
                        <th>Country</th>
                        <th>Confirmed</th>
                    </tr>
                </thead>
                <tbody id="topten">





                </tbody>
            </table>
        </div>

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
            integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
            crossorigin="anonymous"></script>




        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
        <!-- Bootstrap core JavaScript-->
        <script src="vendor/jquery/jquery.min.js"></script>
        <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

        <!-- Core plugin JavaScript-->
        <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

        <!-- Custom scripts for all pages-->
        <script src="js/sb-admin-2.min.js"></script>

        <!-- Page level plugins -->
        <script src="vendor/datatables/jquery.dataTables.min.js"></script>
        <script src="vendor/datatables/dataTables.bootstrap4.min.js"></script>

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
        <script>

            var mymap = L.map('mapid').setView([16.742301, 100.192106], 14);

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                maxZoom: 18,
                attribution: 'GISTNU demo MAP by Leaflet',
                id: 'mapbox.streets'
            }).addTo(mymap);

        </script>
        <script>
            $(document).ready(function () {
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:3000/api/confirmed',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data);

                        $("#confirmed").append();
                        var ID = `${data.total}`
                        $("#confirmed").append(ID)

                    }
                });
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:3000/api/death',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data);

                        $("#death").append();
                        var ID = `${data.total}`
                        $("#death").append(ID)

                    }
                });
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:3000/api/recovered',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data);

                        $("#recovered").append();
                        var ID = `${data.total}`
                        $("#recovered").append(ID)

                    }
                });
                $.ajax({
                    type: "GET",
                    url: "http://localhost:3000/api/map",
                    dataType: "json",
                    success: function (data) {
                        console.log(data.length);
                        let lat = [];
                        let long = [];
                        let country = [];
                        let provice = [];
                        let confirmed = [];
                        let deaths = [];
                        let recovered = [];

                        for (let index = 0; index < data.length; index++) {
                            const element = data[index];
                            console.log(element);

                            lat.push(element.lat);
                            long.push(element.long);
                            country.push(element.country);
                            provice.push(element.province);
                            confirmed.push(element.confirmed);
                            deaths.push(element.deaths);
                            recovered.push(element.recovered);

                            var myIcon = L.icon({
                                iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
                                iconSize: [30, 47.5],
                                iconAnchor: [22, 94],
                                popupAnchor: [-3, -76],
                                shadowSize: [68, 95],
                                shadowAnchor: [22, 94]
                            });

                            var marker = L.marker([element.lat, element.long], { icon: myIcon })
                                .addTo(mymap);
                            marker.bindPopup(
                                "Country : " +
                                element.country +
                                "<br>" +
                                "State : " +
                                element.province +
                                "<br>" +
                                "confirmed : " +
                                element.confirmed +
                                "<br>" +
                                "recovered : " +
                                element.recovered +
                                "<br>" +
                                "deaths : " +
                                element.deaths
                            );
                        }
                    },
                });



            }) 
        </script>
        <script>
            $(document).ready(function () {
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:3000/api/toptentable',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data);

                        let confirmed = [];
                        let country = [];
                        let province = [];
                        for (let index = 0; index < 10; index++) {
                            const element = data[index];
                            console.log(data);

                            $("#topten").append();
                            var ID = `<tr> 
                        <td>${index + 1}</td>      
                    <td>${element.province}</td>
                    <td>${element.country}</td>
                    <td>${element.confirmed}</td>
                    </tr>`
                            $("#topten").append(ID);
                        }



                        $("#toptentable").append();
                        var ID = `${data.total}`
                        $("#toptentable").append(ID)

                    }
                })
            })
        </script>

</body>

</html>